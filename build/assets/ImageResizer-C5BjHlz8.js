import{r as z,j as c,R as E}from"./main-DGCghGMi.js";function x(m,g,p){return Math.min(Math.max(m,g),p)}const r={east:1,north:8,south:2,west:4};function k({onResizeStart:m,onResizeEnd:g,buttonRef:p,imageRef:w,maxWidth:P,editor:v,showCaption:R,setShowCaption:N,captionsEnabled:C}){const y=z.useRef(null),d=z.useRef({priority:"",value:"default"}),f=z.useRef({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),a=v.getRootElement(),b=P||(a!==null?a.getBoundingClientRect().width-20:100),X=a!==null?a.getBoundingClientRect().height-20:100,W=100,$=100,L=t=>{const s=t===r.east||t===r.west,e=t===r.north||t===r.south,u=t&r.north&&t&r.west||t&r.south&&t&r.east,o=s?"ew":e?"ns":u?"nwse":"nesw";a!==null&&a.style.setProperty("cursor",`${o}-resize`,"important"),document.body!==null&&(document.body.style.setProperty("cursor",`${o}-resize`,"important"),d.current.value=document.body.style.getPropertyValue("-webkit-user-select"),d.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},M=()=>{a!==null&&a.style.setProperty("cursor","text"),document.body!==null&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",d.current.value,d.current.priority))},l=(t,s)=>{if(!v.isEditable())return;const e=w.current,u=y.current;if(e!==null&&u!==null){t.preventDefault();const{width:o,height:h}=e.getBoundingClientRect(),i=E(e),n=f.current;n.startWidth=o,n.startHeight=h,n.ratio=o/h,n.currentWidth=o,n.currentHeight=h,n.startX=t.clientX/i,n.startY=t.clientY/i,n.isResizing=!0,n.direction=s,L(s),m(),u.classList.add("image-control-wrapper--resizing"),e.style.height=`${h}px`,e.style.width=`${o}px`,document.addEventListener("pointermove",j),document.addEventListener("pointerup",H)}},j=t=>{const s=w.current,e=f.current,u=e.direction&(r.east|r.west),o=e.direction&(r.south|r.north);if(s!==null&&e.isResizing){const h=E(s);if(u&&o){let i=Math.floor(e.startX-t.clientX/h);i=e.direction&r.east?-i:i;const n=x(e.startWidth+i,W,b),D=n/e.ratio;s.style.width=`${n}px`,s.style.height=`${D}px`,e.currentHeight=D,e.currentWidth=n}else if(o){let i=Math.floor(e.startY-t.clientY/h);i=e.direction&r.south?-i:i;const n=x(e.startHeight+i,$,X);s.style.height=`${n}px`,e.currentHeight=n}else{let i=Math.floor(e.startX-t.clientX/h);i=e.direction&r.east?-i:i;const n=x(e.startWidth+i,W,b);s.style.width=`${n}px`,e.currentWidth=n}}},H=()=>{const t=w.current,s=f.current,e=y.current;if(t!==null&&e!==null&&s.isResizing){const u=s.currentWidth,o=s.currentHeight;s.startWidth=0,s.startHeight=0,s.ratio=0,s.startX=0,s.startY=0,s.currentWidth=0,s.currentHeight=0,s.isResizing=!1,e.classList.remove("image-control-wrapper--resizing"),M(),g(u,o),document.removeEventListener("pointermove",j),document.removeEventListener("pointerup",H)}};return c.jsxs("div",{ref:y,children:[!R&&C&&c.jsx("button",{className:"image-caption-button",ref:p,onClick:()=>{N(!R)},children:"Add Caption"}),c.jsx("div",{className:"image-resizer image-resizer-n",onPointerDown:t=>{l(t,r.north)}}),c.jsx("div",{className:"image-resizer image-resizer-ne",onPointerDown:t=>{l(t,r.north|r.east)}}),c.jsx("div",{className:"image-resizer image-resizer-e",onPointerDown:t=>{l(t,r.east)}}),c.jsx("div",{className:"image-resizer image-resizer-se",onPointerDown:t=>{l(t,r.south|r.east)}}),c.jsx("div",{className:"image-resizer image-resizer-s",onPointerDown:t=>{l(t,r.south)}}),c.jsx("div",{className:"image-resizer image-resizer-sw",onPointerDown:t=>{l(t,r.south|r.west)}}),c.jsx("div",{className:"image-resizer image-resizer-w",onPointerDown:t=>{l(t,r.west)}}),c.jsx("div",{className:"image-resizer image-resizer-nw",onPointerDown:t=>{l(t,r.north|r.west)}})]})}export{k as I};
