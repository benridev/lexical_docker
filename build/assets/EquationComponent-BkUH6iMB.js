import{r as o,j as t,o as x,f as q,$ as h,b as g,a as j,h as p,e as N,p as $,n as S,E as _,K as v}from"./main-DGCghGMi.js";function b({equation:s,setEquation:c,inline:i},e){const n=E=>{c(E.target.value)};return i&&e instanceof HTMLInputElement?t.jsxs("span",{className:"EquationEditor_inputBackground",children:[t.jsx("span",{className:"EquationEditor_dollarSign",children:"$"}),t.jsx("input",{className:"EquationEditor_inlineEditor",value:s,onChange:n,autoFocus:!0,ref:e}),t.jsx("span",{className:"EquationEditor_dollarSign",children:"$"})]}):t.jsxs("div",{className:"EquationEditor_inputBackground",children:[t.jsx("span",{className:"EquationEditor_dollarSign",children:`$$
`}),t.jsx("textarea",{className:"EquationEditor_blockEditor",value:s,onChange:n,ref:e}),t.jsx("span",{className:"EquationEditor_dollarSign",children:`
$$`})]})}const k=o.forwardRef(b);function B({equation:s,inline:c,nodeKey:i}){const[e]=x(),[n,E]=o.useState(s),[u,d]=o.useState(!1),m=o.useRef(null),f=o.useCallback(r=>{d(!1),e.update(()=>{const a=q(i);h(a)&&(a.setEquation(n),r&&a.selectNext(0,0))})},[e,n,i]);return o.useEffect(()=>{!u&&n!==s&&E(s)},[u,s,n]),o.useEffect(()=>u?g(e.registerCommand(N,r=>{const a=document.activeElement;return m.current!==a&&f(),!1},p),e.registerCommand(j,r=>{const a=document.activeElement;return m.current===a?(f(!0),!0):!1},p)):e.registerUpdateListener(({editorState:r})=>{r.read(()=>{const l=$();return S(l)&&l.has(i)&&l.getNodes().length===1})&&d(!0)}),[e,i,f,u]),t.jsx(t.Fragment,{children:u?t.jsx(k,{equation:n,setEquation:E,inline:c,ref:m}):t.jsx(_,{onError:r=>e._onError(r),fallback:null,children:t.jsx(v,{equation:n,inline:c,onDoubleClick:()=>d(!0)})})})}export{B as default};
